---
title: "Visualizing_TTRNA_Data"
author: "Patricka Williams-Simon"
date: "8/20/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(DESeq2)
library(dplyr)
library(stringr)
library(sva)
library(ggplot2)
library(cowplot)
source(file="../../../Scripts/ggplot_theme.R")
```

# MA plot

```{r}
load("../Data/LearnresSVOrder.Rda")
load("../Data/MemresSVOrder.Rda")

# Could do with built-in DESeq2 function:
LearnMAplot <- DESeq2::plotMA(LearnresSVorder, ylim=c(-25,25))
MemMAplot <- DESeq2::plotMA(MemresSVorder, ylim=c(-25,25))

ggsave(LearnMAplot, file="../Plots/LearnMAplot.pdf", width=10, height=4)
ggsave(MemMAplot, file="../Plots/MemMAplot.pdf", width=10, height=4)

# see all results available
resultsNames(LearnresSVorder)
resultsNames(MemresSVorder)


```

#Volcano Plot (ggplot2)


```{r}

load("../Data/LearnresSVOrder.Rda")
load("../Data/MemresSVOrder.Rda")

str(LearnresSVorder)


Learngene_list <- as.data.frame(LearnresSVorder)
Memgene_list <- as.data.frame(MemresSVorder)



Learngene_list <-Learngene_list %>% mutate(Learn_Genes = ifelse(log2FoldChange >= 2, "A", ifelse(log2FoldChange <=-2, "B", "C")))

Memgene_list <-Memgene_list %>% mutate(Mem_Genes = ifelse(log2FoldChange >= 2, "A", ifelse(log2FoldChange <=-2, "B", "C")))


str(Learngene_list)
str(Memgene_list)


Learn_Volcanoplot <- ggplot(Learngene_list, aes(y=-log10(padj), x=log2FoldChange)) +
  geom_point(aes(colour = Learn_Genes), size=1.3, alpha=0.5 ) +
  geom_hline(yintercept = 1.30) +
  scale_color_manual(values=c('red','blue','black'),labels=c('Up Regulated','Down Regulated','Base Levels'))


Learn_Volcanoplot


Mem_Volcanoplot <- ggplot(na.omit(Memgene_list), aes(y=-log10(padj), x=log2FoldChange)) +
  geom_point(aes(colour = Mem_Genes), size=1.3, alpha=0.5 ) +
  geom_hline(yintercept = 1.30) +
  ylab(expression("-log"[10]*"(P"[adj]*")")) +
  xlab(expression("log"[2]*"(fold change)"))+
  scale_color_manual(values=c('red','blue','black'),labels=c('Up Regulated','Down Regulated','Base Levels')) +
  xlim(c(-30,25)) +
   my_theme +
  theme(legend.title=element_blank()) 
 



Mem_Volcanoplot

ggsave(Learn_Volcanoplot, filename="../Plots/Learn_Volcanoplot.pdf", width=6.5, height=3)
ggsave(Mem_Volcanoplot, filename="../Plots/Mem_Volcanoplot.pdf", width=6.5, height=3)


```

